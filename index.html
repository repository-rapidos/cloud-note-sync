
<!-- cfr: https://console.firebase.google.com/project/realtime-app-aada2/database/realtime-app-aada2-default-rtdb/data	 -->


<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Cloud Sync - Pro</title>
	<style>
		:root {
			--bg-color: #0f172a;
			--card-bg: #1e293b;
			--accent-color: #38bdf8;
			--text-main: #f8fafc;
			--text-dim: #94a3b8;
			--msg-bg: #334155;
		}

		body { 
			font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; 
			background: var(--bg-color); 
			color: var(--text-main);
			margin: 0;
			display: flex;
			flex-direction: column;
			height: 100vh;
		}

		/* Header */
		header {
			padding: 15px 20px;
			background: var(--card-bg);
			border-bottom: 1px solid #334155;
			text-align: center;
			font-weight: bold;
			font-size: 1.2rem;
			color: var(--accent-color);
		}

		/* Zone de messages (Scrollable) */
		#chatContainer {
			flex: 1;
			overflow-y: auto;
			padding: 20px;
			display: flex;
			flex-direction: column;
			gap: 15px;
			scrollbar-width: thin;
			scrollbar-color: var(--msg-bg) transparent;
		}

		.message-bubble {
			max-width: 85%;
			background: var(--msg-bg);
			padding: 12px 16px;
			border-radius: 15px 15px 15px 2px;
			align-self: flex-start;
			word-wrap: break-word;
			position: relative;
			animation: fadeIn 0.3s ease;
			box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
		}

		.time {
			display: block;
			font-size: 0.7rem;
			color: var(--text-dim);
			margin-top: 5px;
			text-align: right;
		}

		/* Barre de saisie (Fixée en bas) */
		.input-area {
			background: var(--card-bg);
			padding: 15px;
			display: flex;
			gap: 10px;
			border-top: 1px solid #334155;
		}

		textarea {
			flex: 1;
			background: #0f172a;
			border: 1px solid #334155;
			border-radius: 20px;
			padding: 12px 15px;
			color: white;
			resize: none;
			font-size: 1rem;
			outline: none;
			max-height: 100px;
		}

		textarea:focus { border-color: var(--accent-color); }

		button {
			background: var(--accent-color);
			color: #0f172a;
			border: none;
			border-radius: 50%;
			width: 45px;
			height: 45px;
			cursor: pointer;
			display: flex;
			align-items: center;
			justify-content: center;
			transition: transform 0.2s;
			flex-shrink: 0;
		}

		button:active { transform: scale(0.9); }

		@keyframes fadeIn {
			from { opacity: 0; transform: translateY(10px); }
			to { opacity: 1; transform: translateY(0); }
		}

		/* Responsive */
		@media (max-width: 600px) {
			.message-bubble { max-width: 90%; }
		}
	</style>
</head>
<body>

<header>☁️ Cloud Notes Sync</header>

<div id="chatContainer">
	</div>

<div class="input-area">
	<textarea id="msgInput" placeholder="Saisissez votre note..." rows="1"></textarea>
	<button id="sendBtn">
		<svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path></svg>
	</button>
</div>

<script type="module">
	import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
	import { getDatabase, ref, push, onValue, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

	// // --- REMPLACEZ CE BLOC PAR VOTRE CONFIG REELLE ---
	// const firebaseConfig = {
	// 	apiKey: "VOTRE_API_KEY",
	// 	authDomain: "realtime-app-aada2.firebaseapp.com",
	// 	databaseURL: "https://realtime-app-aada2-default-rtdb.firebaseio.com",
	// 	projectId: "realtime-app-aada2",
	// 	storageBucket: "realtime-app-aada2.appspot.com",
	// 	messagingSenderId: "VOTRE_ID",
	// 	appId: "VOTRE_APP_ID"
	// };


	const firebaseConfig = {
		apiKey: "AIzaSyCr8RHZcTOkhPP182JNYAzMW8cvTBYpL-4",
		authDomain: "realtime-app-aada2.firebaseapp.com",
		databaseURL: "https://realtime-app-aada2-default-rtdb.firebaseio.com",
		projectId: "realtime-app-aada2",
		storageBucket: "realtime-app-aada2.firebasestorage.app",
		messagingSenderId: "84202207595",
		appId: "1:84202207595:web:c52da2251e0428244cb42e",
		measurementId: "G-MPRES3L1KJ"
	};

	const app = initializeApp(firebaseConfig);
	const db = getDatabase(app);
	const messagesRef = ref(db, 'messages');

	const chatContainer = document.getElementById('chatContainer');
	const msgInput = document.getElementById('msgInput');
	const sendBtn = document.getElementById('sendBtn');

	// ENVOYER un message
	function sendMessage() {
		const text = msgInput.value.trim();
		if (text !== "") {
			push(messagesRef, {
				text: text,
				timestamp: serverTimestamp()
			});
			msgInput.value = "";
			msgInput.style.height = 'auto';
		}
	}

	sendBtn.addEventListener('click', sendMessage);
	msgInput.addEventListener('keypress', (e) => { if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendMessage(); } });

	// ÉCOUTER les messages
	onValue(messagesRef, (snapshot) => {
		chatContainer.innerHTML = ""; // On nettoie pour re-afficher la liste
		const data = snapshot.val();
		if (data) {
			Object.values(data).forEach(msg => {
				const div = document.createElement('div');
				div.className = 'message-bubble';
				
				// Formatage de l'heure
				const date = msg.timestamp ? new Date(msg.timestamp).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) : "...";
				
				div.innerHTML = `${msg.text} <span class="time">${date}</span>`;
				chatContainer.appendChild(div);
			});
			chatContainer.scrollTop = chatContainer.scrollHeight; // Auto-scroll vers le bas
		}
	});

	// Auto-resize du textarea
	msgInput.addEventListener('input', function() {
		this.style.height = 'auto';
		this.style.height = (this.scrollHeight) + 'px';
	});
</script>

</body>
</html>
